# `src/AOtoMO/AOtoMO_ERI_RHF.f90`

## Overview

This file provides the `AOtoMO_ERI_RHF` subroutine, designed to transform two-electron repulsion integrals (ERIs) from the Atomic Orbital (AO) basis to the Molecular Orbital (MO) basis. This transformation is a critical step for many quantum chemistry methods. The "RHF" in the name signifies that this routine is intended for use with Restricted Hartree-Fock wavefunctions, where alpha and beta electrons share the same spatial orbitals. The subroutine implements a semi-direct algorithm, which involves a series of matrix multiplications (four steps in this case) to achieve the full four-index transformation, leading to an overall computational scaling of O(N<sup>5</sup>) with respect to the number of basis functions.

## Key Components

*   **Subroutine `AOtoMO_ERI_RHF`**
    *   Description: Transforms two-electron integrals from the AO basis to the MO basis using a semi-direct O(N<sup>5</sup>) algorithm. It is tailored for RHF (Restricted Hartree-Fock) calculations.
    *   Type: Subroutine
    *   Key Arguments/Parameters:
        *   `nBas` (Integer, Input): The number of atomic basis functions.
        *   `nOrb` (Integer, Input): The number of molecular orbitals (typically, occupied and virtual orbitals involved in the post-HF calculation).
        *   `c(nBas,nOrb)` (Double Precision, Input): The matrix of MO coefficients, where columns correspond to molecular orbitals.
        *   `ERI_AO(nBas,nBas,nBas,nBas)` (Double Precision, Input): The array containing the two-electron integrals in the AO basis, often in chemist's notation (μν|λσ).
        *   `ERI_MO(nOrb,nOrb,nOrb,nOrb)` (Double Precision, Output): The array where the transformed two-electron integrals in the MO basis (e.g., (ij|kl)) will be stored.
    *   Return Value: None.

## Important Variables/Constants

*   **`a1(:,:,:,:)`**
    *   Description: An allocatable 4-dimensional array used as a temporary workspace to hold partially transformed integrals. For example, after the second `dgemm` call, it stores integrals of the form (μν|k l).
    *   Type: Double Precision, Allocatable 4D Array
    *   Scope: Local to Subroutine `AOtoMO_ERI_RHF`.
*   **`a2(:,:,:,:)`**
    *   Description: Another allocatable 4-dimensional array used as a temporary workspace. It holds results from the first and third `dgemm` calls. For instance, after the first call, it stores (μνλ|k). Memory for `a1` and `a2` is strategically allocated and deallocated to manage memory usage.
    *   Type: Double Precision, Allocatable 4D Array
    *   Scope: Local to Subroutine `AOtoMO_ERI_RHF`.

## Usage Examples

```fortran
! Example of how to call SUBROUTINE AOtoMO_ERI_RHF
! Ensure nBas, nOrb are correctly defined.
! 'c_matrix' should contain the RHF molecular orbital coefficients.
! 'AO_integrals' are the ERIs in the AO basis.
! 'MO_integrals' will be populated with ERIs in the MO basis.

IMPLICIT NONE
INTEGER :: NBAS_DIM, NORB_DIM
DOUBLE PRECISION, ALLOCATABLE :: C_MATRIX(:,:), AO_INTEGRALS(:,:,:,:), MO_INTEGRALS(:,:,:,:)

! ... (code to initialize NBAS_DIM, NORB_DIM) ...
! ... (code to allocate and fill C_MATRIX, AO_INTEGRALS) ...
! ... (code to allocate MO_INTEGRALS) ...

CALL AOtoMO_ERI_RHF(NBAS_DIM, NORB_DIM, C_MATRIX, AO_INTEGRALS, MO_INTEGRALS)

! MO_integrals now contains the ERIs transformed to the MO basis.
! ... (further calculations using MO_integrals) ...
```

## Dependencies and Interactions

*   **Internal Dependencies:**
    *   `parameters.h`: This is an include file. It likely contains common parameter definitions, such as maximum dimensions, or preprocessor directives used throughout the quantum chemistry package.
*   **External Libraries:**
    *   `dgemm`: This subroutine is a standard routine from BLAS (Basic Linear Algebra Subprograms). It performs general matrix-matrix multiplication (`C = alpha*A*B + beta*C` or transpositions thereof). The four calls to `dgemm` are the computational core of the AO to MO transformation, each call transforming one index of the four-index ERI tensor.
*   **Interactions:**
    *   This subroutine is a cornerstone for many electron correlation methods built upon an RHF reference, such as:
        *   Møller-Plesset perturbation theory (e.g., MP2, MP3).
        *   Configuration Interaction (e.g., CISD, QCISD).
        *   Coupled Cluster theory (e.g., CCD, CCSD, CCSD(T)).
    *   It is typically called after an RHF calculation has converged and before the main part of the correlation calculation begins.

---
*This documentation was auto-generated by a script.*
