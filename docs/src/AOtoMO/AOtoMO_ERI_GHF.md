# `src/AOtoMO/AOtoMO_ERI_GHF.f90`

## Overview

This file provides the `AOtoMO_ERI_GHF` subroutine, which is responsible for transforming two-electron repulsion integrals (ERIs) from the Atomic Orbital (AO) basis to the Molecular Orbital (MO) basis. This specific version is tailored for Generalized Hartree-Fock (GHF) calculations, implying it handles spin orbitals directly. The transformation uses a semi-direct algorithm, which typically involves a sequence of matrix multiplications to achieve the four-index transformation with a computational cost of O(N<sup>5</sup>).

## Key Components

*   **Subroutine `AOtoMO_ERI_GHF`**
    *   Description: Performs the AO to MO transformation of two-electron integrals. The comment "`! bra and ket are the spin of (bra1 bra2|ket1 ket2)`" indicates that the routine processes integrals where spin components are considered.
    *   Type: Subroutine
    *   Key Arguments/Parameters:
        *   `nBas` (Integer, Input): The number of atomic basis functions.
        *   `nBas2` (Integer, Input): The number of molecular orbitals (or the transformed basis dimension).
        *   `c1(nBas,nBas2)` (Double Precision, Input): The coefficient matrix for the first and third indices of the ERI transformation.
        *   `c2(nBas,nBas2)` (Double Precision, Input): The coefficient matrix for the second and fourth indices of the ERI transformation.
        *   `ERI_AO(nBas,nBas,nBas,nBas)` (Double Precision, Input): The array of two-electron integrals in the AO basis.
        *   `ERI_MO(nBas2,nBas2,nBas2,nBas2)` (Double Precision, Output): The array where the transformed two-electron integrals in the MO basis will be stored.
    *   Return Value: None.

## Important Variables/Constants

*   **`scr(:,:,:,:)`**
    *   Description: An allocatable 4-dimensional array used as scratch space for intermediate results during the multi-step transformation of the integrals.
    *   Type: Double Precision, Allocatable 4D Array
    *   Scope: Local to Subroutine `AOtoMO_ERI_GHF`.
*   **`mu, nu, la, si`**
    *   Description: Integer variables used as loop indices, likely iterating over AO basis functions during implicit or explicit loops within the `dgemm` calls.
    *   Type: Integer
    *   Scope: Local to Subroutine `AOtoMO_ERI_GHF`.
*   **`i, j, k, l`**
    *   Description: Integer variables used as loop indices, likely iterating over MO basis functions.
    *   Type: Integer
    *   Scope: Local to Subroutine `AOtoMO_ERI_GHF`.

## Usage Examples

```fortran
! Example of how to call SUBROUTINE AOtoMO_ERI_GHF
! Ensure nBas, nBas2 are defined.
! Ensure ERI_AO are the two-electron integrals in AO basis.
! Ensure c1 and c2 are the appropriate GHF MO coefficient matrices.
! ERI_MO will contain the transformed integrals.
IMPLICIT NONE
INTEGER :: NBAS_VAL, NBAS2_VAL
DOUBLE PRECISION, ALLOCATABLE :: ERI_AO_EXAMPLE(:,:,:,:), C1_EXAMPLE(:,:), C2_EXAMPLE(:,:), ERI_MO_EXAMPLE(:,:,:,:)

! ... (initialize NBAS_VAL, NBAS2_VAL, allocate and fill ERI_AO_EXAMPLE, C1_EXAMPLE, C2_EXAMPLE) ...
! ... (allocate ERI_MO_EXAMPLE) ...

CALL AOtoMO_ERI_GHF(NBAS_VAL, NBAS2_VAL, C1_EXAMPLE, C2_EXAMPLE, ERI_AO_EXAMPLE, ERI_MO_EXAMPLE)

! ... (use ERI_MO_EXAMPLE) ...
```

## Dependencies and Interactions

*   **Internal Dependencies:**
    *   `parameters.h`: This is an include file. It likely contains predefined parameters, array sizes, or preprocessor directives that are common across multiple files in the project.
*   **External Libraries:**
    *   `dgemm`: This subroutine, a standard routine from BLAS (Basic Linear Algebra Subprograms), is used extensively to perform matrix-matrix multiplications. The four calls to `dgemm` implement the O(N<sup>5</sup>) transformation steps.
*   **Interactions:**
    *   This subroutine is a crucial component in quantum chemistry programs that use GHF wavefunctions and need to perform post-Hartree-Fock calculations (like MP2, Coupled Cluster, etc.). It transforms the fundamental ERI quantities from the AO basis (in which they are typically computed) to the MO basis (which is the working basis for most electron correlation methods).

---
*This documentation was auto-generated by a script.*
