# `src/AOtoMO/complex_AOtoMO.f90`

## Overview

This file contains the `complex_AOtoMO` subroutine, which performs an Atomic Orbital (AO) to Molecular Orbital (MO) transformation of a real symmetric matrix `M_AOs` (e.g., a Hamiltonian or overlap matrix in an AO basis) using a set of complex MO coefficients `C`. The resulting matrix `M_MOs` in the MO basis is complex. The transformation implemented is M_MOs = C<sup>T</sup> * M_AOs * C, where C<sup>T</sup> denotes the transpose of the complex coefficient matrix `C`.

## Key Components

*   **Subroutine `complex_AOtoMO`**
    *   Description: Transforms a real matrix `M_AOs` from the AO basis to a complex matrix `M_MOs` in the MO basis using complex MO coefficients `C`.
    *   Type: Subroutine
    *   Key Arguments/Parameters:
        *   `nBas` (Integer, Input): The number of atomic basis functions.
        *   `nOrb` (Integer, Input): The number of molecular orbitals.
        *   `C(nBas,nOrb)` (Complex\*16, Input): The matrix of complex MO coefficients.
        *   `M_AOs(nBas,nBas)` (Double Precision, Input): The real matrix in the AO basis to be transformed.
        *   `M_MOs(nOrb,nOrb)` (Complex\*16, Output): The resulting complex matrix in the MO basis.
    *   Return Value: None.

## Important Variables/Constants

*   **`AC(:,:)`**
    *   Description: An allocatable 2D array of type `complex*16`. It is used as a temporary workspace to store the intermediate product of `M_AOs` (real) and `C` (complex), resulting in a complex matrix `AC = M_AOs * C`.
    *   Type: `complex*16`, Allocatable
    *   Scope: Local to Subroutine `complex_AOtoMO`.
*   **`complex_C(:,:)`**
    *   Description: An allocatable 2D array of type `complex*16`. This variable is declared in the subroutine but is not used in the executable statements. It might be a leftover from previous code versions or intended for future extensions.
    *   Type: `complex*16`, Allocatable
    *   Scope: Local to Subroutine `complex_AOtoMO`.

## Usage Examples

```fortran
! Example of how to call SUBROUTINE complex_AOtoMO
IMPLICIT NONE
INTEGER :: NUM_BASIS, NUM_ORBITALS
COMPLEX(KIND=KIND(0.0d0)), ALLOCATABLE :: MO_COEFFICIENTS(:,:), MO_OPERATOR_MATRIX(:,:)
DOUBLE PRECISION, ALLOCATABLE :: AO_OPERATOR_MATRIX(:,:)

! Define dimensions
NUM_BASIS = 10
NUM_ORBITALS = 5

! Allocate arrays
ALLOCATE(MO_COEFFICIENTS(NUM_BASIS, NUM_ORBITALS))
ALLOCATE(AO_OPERATOR_MATRIX(NUM_BASIS, NUM_BASIS))
ALLOCATE(MO_OPERATOR_MATRIX(NUM_ORBITALS, NUM_ORBITALS))

! Initialize input matrices (example values)
! MO_COEFFICIENTS would typically come from a complex HF or DFT calculation
DO J = 1, NUM_ORBITALS
    DO I = 1, NUM_BASIS
        MO_COEFFICIENTS(I,J) = CMPLX(REAL(I+J)/REAL(NUM_BASIS*NUM_ORBITALS), -REAL(I-J)/REAL(NUM_BASIS*NUM_ORBITALS), KIND=KIND(0.0d0))
    END DO
END DO
AO_OPERATOR_MATRIX = 1.0 / REAL(NUM_BASIS) ! Simplified initialization

! Call the subroutine
CALL complex_AOtoMO(NUM_BASIS, NUM_ORBITALS, MO_COEFFICIENTS, AO_OPERATOR_MATRIX, MO_OPERATOR_MATRIX)

! MO_OPERATOR_MATRIX now contains the operator transformed to the complex MO basis
PRINT *, 'Transformed MO Matrix (real part):'
DO I = 1, NUM_ORBITALS
    PRINT *, (REAL(MO_OPERATOR_MATRIX(I,J)), J=1,NUM_ORBITALS)
END DO
PRINT *, 'Transformed MO Matrix (imaginary part):'
DO I = 1, NUM_ORBITALS
    PRINT *, (AIMAG(MO_OPERATOR_MATRIX(I,J)), J=1,NUM_ORBITALS)
END DO

! Deallocate arrays
DEALLOCATE(MO_COEFFICIENTS, AO_OPERATOR_MATRIX, MO_OPERATOR_MATRIX)

END
```

## Dependencies and Interactions

*   **Internal Dependencies:**
    *   None explicitly shown via `USE` statements as the file contains a single subroutine.
*   **External Libraries:**
    *   `matmul`: This is an intrinsic Fortran function used for performing matrix multiplication.
    *   `transpose`: This is an intrinsic Fortran function used for transposing a matrix.
*   **Interactions:**
    *   This subroutine is likely used in quantum chemistry programs that deal with complex molecular orbitals. This can occur in situations such as:
        *   Systems under the influence of an external magnetic field.
        *   Non-Hermitian quantum chemistry methods.
        *   Certain types of resonant state calculations or time-dependent phenomena.
    *   It transforms a real operator (like the kinetic energy or nuclear attraction, or a real effective potential) from the AO basis to the MO basis defined by these complex orbitals.

---
*This documentation was auto-generated by a script.*
